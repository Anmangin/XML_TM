<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="style.css"> -->
     <style>
        /* Global Styles */
body {
    max-width: 902px; /* Largeur utilisable dans Word avec marges standards */
    margin: 0 auto; /* Centre le contenu horizontalement */
    padding: 0; /* Pas de marge interne supplémentaire */
    font-family: 'Arial', sans-serif; /* Police standard Word */
    line-height: 1.5; /* Espacement de ligne standard dans Word */
    box-sizing: border-box; /* Garantit que le padding n'ajoute pas à la largeur */
}
.sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: 250px;
    height: 100%;
    background-color: #f4f4f4;
    padding-top: 20px;
    padding-left: 10px;
    overflow-y: auto;
    border-right: 2px solid #ccc;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
}

.sidebar h3 {
    font-size: 20px;
    color: #333;
    margin-bottom: 15px;
}

/* Sidebar Links */
.sidebar a {
    display: block;
    padding: 10px;
    text-decoration: none;
    color: #333;
    font-size: 12px;
    margin-bottom: 0px;
    border-radius: 0px;
}

.sidebar a:hover {
    background-color: #ddd;
}


/* Styles généraux de la sidebar */
.sidebar {
    width: 300px;
    padding: 10px;
    background-color: #f4f4f4;
    border-right: 2px solid #ccc;
}

.sidebar a {
    display: block;
    color: #007bff;
    text-decoration: none;
    padding: 5px;
    margin-bottom: 5px;
}

.sidebar a:hover {
    background-color: #ddd;
}

/* Ajouter une indentation pour les titres H2 dans la sidebar */
.sidebar a {
    padding-left: 0;
}

.sidebar a[data-target^="h2"] {
    padding-left: 20px;  /* Indentation pour les titres H2 */
}



/* Contenu Principal */
.content {
    margin-left: 50px; /* Décalage pour laisser de la place à la sidebar */
    padding: 20px;
    background-color: #fff;
    /* min-height: 100vh; */
    width:100%;
}

section {

    display: none;  
}
h1 {
display: none;
width:100%;
}

/* Titre */
h2, h3 {
    color: #3b7bc0;
    text-align: center;
    margin-bottom: 20px;
    width:100%;
}

h2 {
    font-size: 16px;
}

h3 {
    font-size: 14px;
    text-align: left; /* Aligne le texte à gauche */
    background-color: #3b7bc0; /* Couleur de fond bleue */
    color: white; /* Couleur du texte */
    padding: 10px; /* Espacement interne */
    border-radius: 8px; /* Coins arrondis */
    margin: 10px 0; /* Espacement externe (haut et bas) */
    display: block; /* Assure que l'élément prend toute la largeur disponible */
    width: 100%; /* Assure que l'élément couvre toute la largeur */
    box-sizing: border-box; /* Inclut le padding dans la largeur totale */
}

/* Table Styles */
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    background-color: #fff;
}

th, td {
     padding: 3px 5px; 
    text-align: left;
     border: 1px solid #dee2e6; 
}

th {
    background-color: #3b7bc0;
    color: #fff;
    text-align: center;
    font-weight: bold;
}

td {
    vertical-align: center;
    font-size: 10px;
}

tr:nth-child(even) {
    background-color: #f1f1f1;
}

/* Highlight Specific Content */
td b {
    color: #dc3545; /* Red for emphasis */
}

/* Details/Notes */
details {
    font-size: 0.9rem;
    background-color: #e9ecef;
    border: 1px solid #ced4da;
    border-radius: 5px;
    padding: 5px 10px;
    margin-top: 10px;
}

details summary {
    font-weight: bold;
    cursor: pointer;
    color: #495057;
}

/* List and Possible Responses */
ul {
    list-style-type: none;
    padding: 0;
}

li {
    margin: 5px 0;
}

/* Icon Styling */
td.center {
    text-align: center;
    font-size: 1.2rem;
}

td .red {
    color: rgba(255, 0, 0, 0.322);
}

/* Footnotes and Notes */
p {
    margin: 10px 0;
    font-size: 1rem;
    color: #6c757d;
    text-align: center;
}

code {
    background-color: #f8f9fa;
    padding: 3px 5px;
    border-radius: 3px;
    font-family: monospace;
    font-size: 0.9rem;
}



/* Cacher les sections avec la classe "hidden" */
.hidden {
    /* display: none !important;; Cache complètement l'élément */
    visibility: hidden  !important; /* L'élément est invisible mais prend de la place */
}

/* Montrer les sections avec la classe "show" */
.show {
    display: block !important;; /* Affiche l'élément en tant que bloc */
}

  @media print {
    h1 {
        page-break-before: always; /* Force un saut de page avant chaque h1 */
        text-align: center; /* Centre le texte */
        margin-top: 30%; /* Ajoute un espace avant le h1 pour le centrer verticalement */
        margin-bottom: 0; /* Enlève la marge inférieure pour éviter de l'espace inutile après le h1 */
        width:100%;
    }
    h2 {
        page-break-before: always;
        padding: 0px; /* Espaces internes */
        margin-bottom: 0px;
        width:100%;
    }
    h3 {
        padding: 0px; /* Espaces internes */
        margin-bottom: 0px;
        width:100%;
    }
    section {
        padding: 0px; /* Espaces internes */
        margin-bottom: 0px;
        width:100%;
    }

    .sidebar {
        position: fixed; /* La sidebar reste fixe à gauche */
        top: 0;
        left: 0;
        width: 250px;  /* Largeur normale de la sidebar */
        padding: 0px; /* Espaces internes */

        margin-left: 0mm;
        box-shadow: none; /* Enlève l'ombre pendant l'impression */
        border:none;
        height: 100%;  /* Prend toute la hauteur de la page */
        padding: 5px;
        font-size: 10px; /* Réduit la taille de la police pour s'ajuster */
        line-height: 1.05; /* Réduit l'espacement entre les lignes pour plus de texte */
        display: block;
        page-break-inside: avoid; /* Évite que la sidebar soit coupée entre les pages */
        page-break-before: always; /* Force la sidebar à commencer sur chaque nouvelle page */
    }


    .sidebar a{
        padding: 0px; /* Espaces internes */
        margin: -0mm;
        font-size: 9pt; /* Ajuste la taille de la police pour l'impression */
    }
    .sidebar button{
        display: none !important;; /* Cache complètement l'élément */
    }
    .sidebar h3{
        display: none !important;; /* Cache complètement l'élément */
    }
    .content {
            width: 75%;  /* Largeur normale de la sidebar */
            padding: 0px; /* Espaces internes */
            margin-left: 270px;
            
    
        }

    
    /* Empêcher la coupure de l'élément */
    body {
         max-width: 602px; /* Largeur utilisable dans Word avec marges standards */
         margin-left: 0mm; 
         font-size: 12pt; /* Ajuste la taille de la police pour l'impression */
    }
    .no-break {
        page-break-inside: avoid;
        break-inside: avoid; /* Pour les navigateurs modernes */
    }
    .no-print {
        display: none !important;
    }
}

#toggle-button {
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 5px;
}
#toggle-button.released {
    background-color: #6C757D;
}

/* Par défaut, les éléments sont cachés */
[data-visual="DM"] {
    display: table-cell;
}

.container {
    display: flex;
    flex-wrap: wrap; /* Permet aux éléments de se déplacer sur plusieurs lignes si nécessaire */
}

.column {
    flex: 1 1 200px; /* Permet à chaque colonne de croître, de rétrécir, et d'avoir une largeur de base de 200px */
    margin: 10px;
}

.priority-column {
    flex: 2 1 200px; /* Cette colonne prend plus d'espace lorsqu'il y en a */
    
}

.center-content {
    text-align: center; /* Centre le contenu horizontalement */
}

.center-content button {
    display: inline-block; /* Permet de centrer le bouton */
}
     </style>
     <title> </title>
     
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <button id="toggle-button" class="pressed" data-state="DM">DM</button>
        <button id="print">imprimer les modifications</button>
        <!-- <button onclick="saveAsWord()">Save as Word</button> -->
        <script>
            function saveAsWord() {
                // Sélectionne le contenu de la page
                const content = document.documentElement.outerHTML;
    
                // Crée un blob avec le contenu en type MIME pour Word
                const blob = new Blob(['\ufeff' + content], {
                    type: 'application/msword'
                });
    
                // Crée un lien temporaire pour télécharger le fichier
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'page.doc'; // Nom du fichier par défaut
    
                // Simule un clic sur le lien pour lancer le téléchargement
                link.click();
    
                // Libère l'URL temporaire
                URL.revokeObjectURL(link.href);
            }
        </script>
      

        <script>
               // Sélectionne le bouton et ajoute un écouteur d'événement
        // Récupérer le chemin de l'URL
        const pathname = window.location.pathname;

        // Extraire uniquement le nom du fichier
        let filename = pathname.substring(pathname.lastIndexOf('/') + 1);

        // Décoder les caractères spéciaux (comme %20 pour les espaces)
        filename = decodeURIComponent(filename);

        // Supprimer les extensions multiples (comme .html.pdf)
        filename = filename.replace(/\.(\w+)(\.\w+)+$/, ''); // Garde la première extension uniquement

        // Supprimer toute extension si nécessaire
        filename = filename.replace(/\.\w+$/, '');

        // Modifier le contenu de la balise <title>
        document.title = filename;
            // Sélectionne le bouton et ajoute un écouteur d'événement
            document.getElementById('print').addEventListener('click', function () {
                // Vérifie si le document contient un 🔴
                if (document.body.innerText.includes('🔴')) {
                    // Obtenir la date actuelle et formater en YY.MM.DD
                    const now = new Date();
                    const year = String(now.getFullYear()).slice(-2); // Année sur 2 chiffres
                    const month = String(now.getMonth() + 1).padStart(2, '0'); // Mois sur 2 chiffres
                    const day = String(now.getDate()).padStart(2, '0'); // Jour sur 2 chiffres
        
                    // Ajouter -MOD:YY.MM.DD au nom du fichier
                    filename += `-MOD:${year}.${month}.${day}`;
                }
        
                // Mettre à jour le titre de la page
                document.title = filename;
        
                // Lance la boîte de dialogue d'impression
                window.print();
            });
        </script>


        <h3>Table des matières</h3>
        <div id="sidebar-links"></div>
    </div>

    <!-- Main Content -->
    <div class="content" id="main-content">
    </div>
    <div class="content" id="change-log" style="margin-top: 20px;">
        <h3>Liste des changements à faire</h3>
        <table id="change-table" border="1" style="border-collapse: collapse; width: 100%;">
            <thead>
                <tr>
                    <th>Fiche</th>
                    <th>caption</th>
                    <th>Description modifié</th>
                    <th>Response Type</th>
                    <th>SAS Name</th>
                </tr>
            </thead>
            <tbody id="change-list"></tbody>
        </table>
    </div>
    <script>
        function loadJSON(filePath) {
    return fetch(filePath) // Charge le fichier JSON à partir du chemin spécifié
        .then(response => {
            if (!response.ok) {
                throw new Error('Erreur lors du chargement du fichier JSON');
            }
            return response.json(); // Parse le contenu du fichier JSON
        })
        .then(data => {
            return data; // Renvoie les données JSON une fois qu'elles sont chargées
        })
        .catch(error => {
            console.error('Erreur:', error); // Gère les erreurs
            return null; // Retourne null en cas d'erreur
        });
}
</script>



<script>

const jsonData = {"visites": [{"V_description": "Patient Template", "fiches": [{"F_description": "Patient Information", "groupes": [{"G_description": "REFUSLABEL", "questions": [{"GI_key": "8b47d6e4-fb5c-4997-9976-47f03fd67912", "Item_Order": 1, "I_description": "<b><font color=\"#ff0099\">Message from promotor</font></b>", "I_caption": "REFUSLABEL", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][PAT.*][REFUSLABEL.*][REFUSLABEL]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>var resp=\"\";<br><br>if ( [Trial Template][TRIAL][Trial][INCLTRIAL] == '0' ) <br>resp = ' the trial ' + [Trial Template][TRIAL][Trial][Trial Name] + ' is closed, please contact the data manager';<br>else if( [Trial Template][Site template][SITE][Site Information][INCLSITE]=='0' ) <br>resp = 'the site ' + [Trial Template][Site template][SITE][Site Information][Site Name] + ' is closed, please contact the data manager';<br>else resp = \"\";<br>resp ; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 1", "I_Status": "", "i_SasName": "REFUSLAB"}, {"GI_key": "c48d00ad-d586-4d64-93b7-92f32d6dea80", "Item_Order": 2, "I_description": "Hard check to prevent save", "I_caption": "HCHECK", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][PAT.*][REFUSLABEL.*][HCHECK]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>'Inclusion not allowed'; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Num - 50", "I_Status": "", "i_SasName": "HCHECK"}]}, {"G_description": "Patient Information", "questions": [{"GI_key": "67dbfdac-556b-4d0a-a902-575a38f6bc65", "Item_Order": 3, "I_description": "First name initial", "I_caption": "First name initial", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][First name initial]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>isNaN([Trial Template][Site template][Patient Template][PAT][Patient Information][First name initial]) <br>#data Expression <br> <br></code></pre> </td><td> Please enter a letter.</td> </tr></table></details>", "rep": "Char - 1", "I_Status": "", "i_SasName": "FNAME"}, {"GI_key": "b2c6615c-3204-4458-9456-cef02577f6d3", "Item_Order": 4, "I_description": "Last name initial", "I_caption": "Last name initial", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][Last name initial]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>isNaN([Trial Template][Site template][Patient Template][PAT][Patient Information][Last name initial]); <br>#data Expression <br> <br></code></pre> </td><td> Please enter a letter.</td> </tr></table></details>", "rep": "Char - 1", "I_Status": "", "i_SasName": "LNAME"}, {"GI_key": "549e634f-eb9a-4baf-b764-f8d1daadcbca", "Item_Order": 5, "I_description": "Patient Number", "I_caption": "Patient Number", "Message": "Cat\u00e9rogie:Site Data<br><details> <summary>2 EditCheck </summary><table><tr><td> DVC:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][Patient Number]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>var FN=[Trial Template][Site template][Patient Template][PAT][Patient Information][First name initial];<br>var LN=[Trial Template][Site template][Patient Template][PAT][Patient Information][Last name initial];<br>var DNAIS=[Trial Template][Site template][Patient Template][PAT][Patient Information][DNAIS];<br>var SEX=[Trial Template][Site template][Patient Template][PAT][Patient Information][SEX];<br>var num=[Trial Template][Site template][Patient Template][PAT][Patient Information][Patient Number];<br>!isEmpty(FN) && <br>!isEmpty(LN) && <br>!isEmpty(DNAIS) &&<br>!isEmpty(SEX) && <br>isEmpty(num) ; <br>#data Expression <br>GetNextNumber(TrialLevel); <br></code></pre> </td><td> </td> </tr><tr><td> Hidden:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][Patient Number]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>isEmpty([Trial Template][Site template][Patient Template][PAT][Patient Information][Patient Number]); <br>#data Expression <br> <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 50", "I_Status": "\ud83d\udd12", "i_SasName": "PTNO"}, {"GI_key": "4b312c81-564a-4e4f-8ce2-d8906e7c1db7", "Item_Order": 6, "I_description": "Birthdate", "I_caption": "DNAIS", "Message": null, "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "", "i_SasName": "DNAIS"}, {"GI_key": "5c1855d2-be3c-4e91-9fac-a0e12d294b7c", "Item_Order": 7, "I_description": "Sex", "I_caption": "SEX", "Message": null, "rep": "\ud83d\udd18 1 - <b>Male</b><br>\ud83d\udd18 2 - <b>Female</b>", "I_Status": "", "i_SasName": "SEX"}, {"GI_key": "c07944c4-f75b-4867-bf33-3ee2efb2c2c6", "Item_Order": 8, "I_description": "Patient Caption", "I_caption": "Patient Caption", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "Char - 50", "I_Status": "\ud83d\udc7b\ud83d\udd12", "i_SasName": "PATIEN"}, {"GI_key": "5d316d68-9e6e-4fec-afb4-06e71ac006c0", "Item_Order": 9, "I_description": "Active", "I_caption": "Active", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "\ud83d\udd18 NO - <b>NO</b><br>\ud83d\udd18 YES - <b>YES</b>", "I_Status": "\ud83d\udc7b", "i_SasName": "PTACTV"}, {"GI_key": "3e0b9746-c4c2-416a-8efc-3dfffcc72689", "Item_Order": 10, "I_description": "Dropped", "I_caption": "Dropped", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "\ud83d\udd18 NO - <b>NO</b><br>\ud83d\udd18 YES - <b>YES</b>", "I_Status": "\ud83d\udc7b", "i_SasName": "PTDROP"}, {"GI_key": "454df3dc-6245-48bf-854b-84b6d8296e2f", "Item_Order": 11, "I_description": "Enrolled", "I_caption": "Enrolled", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "\ud83d\udd18 NO - <b>NO</b><br>\ud83d\udd18 YES - <b>YES</b>", "I_Status": "\ud83d\udc7b", "i_SasName": "PTENRL"}, {"GI_key": "b0024dab-de6f-4638-91f3-0f2123ec0cd7", "Item_Order": 12, "I_description": "Registration Date", "I_caption": "Registration Date", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "\ud83d\udc7b", "i_SasName": "RGSTDT"}, {"GI_key": "eea3142d-d8db-45c0-a94d-ed77d9fb4040", "Item_Order": 13, "I_description": "Enroll Date", "I_caption": "Enroll Date", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "\ud83d\udc7b", "i_SasName": "PTERDT"}, {"GI_key": "b12e0df0-9e1c-4611-bef5-a0a6de2b793f", "Item_Order": 14, "I_description": "Randomization Number", "I_caption": "Randomization Number", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "Char - 50", "I_Status": "\ud83d\udc7b", "i_SasName": "PTRNNO"}, {"GI_key": "d945bd07-46a4-46c9-94cc-ca60909d039e", "Item_Order": 15, "I_description": "Randomization Date", "I_caption": "Randomization Date", "Message": "Cat\u00e9rogie:Site Data<br>", "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "\ud83d\udc7b", "i_SasName": "PTRNDT"}, {"GI_key": "b03c350f-a450-4e82-b298-85fdd063721d", "Item_Order": 16, "I_description": "Check of duplicate patient", "I_caption": "CHECKDUPLICATE", "Message": "<details> <summary>2 EditCheck </summary><table><tr><td> 17:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][CHECKDUPLICATE]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true <br>#data Expression <br>1 <br></code></pre> </td><td> This value must be unique.</td> </tr><tr><td> DVA:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][CHECKDUPLICATE]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>var FNAME=[Trial Template][Site template][Patient Template][PAT][Patient Information][First name initial];<br>var LNAME=[Trial Template][Site template][Patient Template][PAT][Patient Information][Last name initial];<br>var SEX=[Trial Template][Site template][Patient Template][PAT][Patient Information][SEX];<br>var DNAIS = [Trial Template][Site template][Patient Template][PAT][Patient Information][DNAIS];<br>var over=[Trial Template][Site template][Patient Template][PAT][Patient Information][OVERDUP]<br>FNAME+LNAME+SEX+DNAIS+over; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 50", "I_Status": "\ud83d\udd12", "i_SasName": "CHECKDUP"}, {"GI_key": "3ad1833b-bc66-4cd9-9d1e-6ef6291682dc", "Item_Order": 17, "I_description": "Overrule the duplicate check (DM only)", "I_caption": "OVERDUP", "Message": "Cat\u00e9rogie:DM<br>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "OVERDUP"}, {"GI_key": "8188cd1a-db5f-4996-9eed-37ba4612d794", "Item_Order": 18, "I_description": "<b><font color=\"#ff0000\">Check blockage inclusion</font></b>", "I_caption": "CHECKINCLUSION", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][PAT.*][Patient Information.*][CHECKINCLUSION]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>var dat =[Trial Template][Site template][Patient Template][PAT][Patient Information][DNAIS] + '/15';<br>var now=TodayDate();<br>var age=AgeAtGivenDate(dat,now);<br>if (age<18) \"PATIENT MINEUR\";<br>else \"\"; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Num - 500", "I_Status": "\ud83d\udd12", "i_SasName": "CHECKDU1"}]}, {"G_description": "Consent", "questions": [{"GI_key": "42e7dbd7-98fa-47df-ab5e-0cb2f54b1d94", "Item_Order": 19, "I_description": "Informed consent signature date by the patient", "I_caption": "PCONSDT", "Message": null, "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "", "i_SasName": "PCONSDT"}, {"GI_key": "dec0cf25-9532-4944-940c-c976ee0daba0", "Item_Order": 20, "I_description": "Informed consent signature date by the investigator", "I_caption": "ICONSDT", "Message": null, "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "", "i_SasName": "ICONSDT"}, {"GI_key": "32cac8c1-7714-4d72-9ac6-fa5d23b8f8e2", "Item_Order": 21, "I_description": "Version of informed consent signed", "I_caption": "CONSVERS", "Message": null, "rep": "Char - 50", "I_Status": "", "i_SasName": "CONSVERS"}, {"GI_key": "1b600b6c-d304-4488-82fa-8622e31ea8d8", "Item_Order": 22, "I_description": "Age at inclusion", "I_caption": "AGE_INCLUSION", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][PAT.*][Consent.*][AGE_INCLUSION]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>var dnais = [Trial Template][Site template][Patient Template][PAT][Patient Information][DNAIS];<br>var consent = [Trial Template][Site template][Patient Template][PAT][Consent][PCONSDT];<br>!isEmpty(dnais) && !isEmpty(consent); <br>#data Expression <br>var dnais = [Trial Template][Site template][Patient Template][PAT][Patient Information][DNAIS]+ '/01';<br>var consent = [Trial Template][Site template][Patient Template][PAT][Consent][PCONSDT];<br>AgeAtGivenDate(dnais,consent); <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Num - 3", "I_Status": "\ud83d\udc7b\ud83d\udd12", "i_SasName": "AGE_INCL"}, {"GI_key": "fbceeade-b8b6-4088-aafc-f806bcaba593", "Item_Order": 23, "I_description": "<b><font color=\"#ff0000\">Check blockage inclusion</font></b>", "I_caption": "CHECKINCLUSION", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][PAT.*][Consent.*][CHECKINCLUSION]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>var dnais = [Trial Template][Site template][Patient Template][PAT][Patient Information][DNAIS];<br>var pconsent = [Trial Template][Site template][Patient Template][PAT][Consent][PCONSDT];<br>var iconsent = [Trial Template][Site template][Patient Template][PAT][Consent][ICONSDT];<br>var age=[Trial Template][Site template][Patient Template][PAT][Consent][AGE_INCLUSION];<br><br>var fname= [Trial Template][Site template][Patient Template][PAT][Patient Information][First name initial];<br>var lname = [Trial Template][Site template][Patient Template][PAT][Patient Information][Last name initial];<br>var sex=[Trial Template][Site template][Patient Template][PAT][Patient Information][SEX];<br>var comment =\"\";<br><br><br>if( isEmpty(dnais)) comment +=\"Birthdate Empty-\";<br>if (isEmpty(pconsent )) comment  +=\"patient consent date Empty-\";<br>if (isEmpty(iconsent )) comment  +=\"investigator consent date Empty-\";<br>if (isEmpty(fname)) comment  +=\" first name Empty-\";<br>if (isEmpty(lname)) comment  +=\" last name Empty-\";<br>if (isEmpty(sex)) comment  +=\" sex is Empty-\";<br><br>if (Number(age)<18) comment  +=\"patient under 18\";<br>comment ; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Num - 500", "I_Status": "\ud83d\udd12", "i_SasName": "CHECKDU1"}]}]}]}, {"V_description": "Randomisation", "fiches": [{"F_description": "Inclusion Criteria", "groupes": [{"G_description": "IC", "questions": [{"GI_key": "6af7417c-150c-4da8-b1b7-d5fc2cb959d0", "Item_Order": 24, "I_description": "IC01", "I_caption": "IC01", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC01]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC01]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC01"}, {"GI_key": "b8584fc0-3b8d-42e1-875c-b5ad5142939a", "Item_Order": 25, "I_description": "IC02", "I_caption": "IC02", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC02]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC02]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC02"}, {"GI_key": "10b1dd9b-76f6-4fea-acc4-5eb6613f9ca9", "Item_Order": 26, "I_description": "IC03", "I_caption": "IC03", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC03]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC03]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC03"}, {"GI_key": "13df7e61-07de-4e5b-a88f-342f9bbec0cf", "Item_Order": 27, "I_description": "IC04", "I_caption": "IC04", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC04]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC04]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC04"}, {"GI_key": "755096e3-f464-4ccb-a7bb-6bcb54e49330", "Item_Order": 28, "I_description": "IC05", "I_caption": "IC05", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC05]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC05]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC05"}, {"GI_key": "ea9e405b-f537-4ac1-bd79-b88e6ed09440", "Item_Order": 29, "I_description": "IC06", "I_caption": "IC06", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC06]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC06]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC06"}, {"GI_key": "2bc636d5-9f9c-4f8e-880b-1ebff9de4c13", "Item_Order": 30, "I_description": "IC07", "I_caption": "IC07", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC07]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC07]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC07"}, {"GI_key": "f32286f7-28ef-4eb9-9c98-e888fc7a89c0", "Item_Order": 31, "I_description": "IC08", "I_caption": "IC08", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC08]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC08]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC08"}, {"GI_key": "6869b06a-25c8-41dc-bf5f-1cdec04f9ac3", "Item_Order": 32, "I_description": "IC09", "I_caption": "IC09", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC09]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC09]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC09"}, {"GI_key": "48c099c0-574d-49af-8755-887c011ba00b", "Item_Order": 33, "I_description": "IC10", "I_caption": "IC10", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC10]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC10]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC10"}, {"GI_key": "0df2218b-01e0-40d3-a326-f37816ff56dc", "Item_Order": 34, "I_description": "IC11", "I_caption": "IC11", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC11]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC11]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC11"}, {"GI_key": "2e3c61d3-882c-4295-961d-b875e097c7f2", "Item_Order": 35, "I_description": "IC12", "I_caption": "IC12", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC12]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC12]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC12"}, {"GI_key": "5ee43669-b294-4dbc-bea7-6c2e9a8f76fc", "Item_Order": 36, "I_description": "IC13", "I_caption": "IC13", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC13]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC13]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC13"}, {"GI_key": "089ceaf2-d6de-457c-b345-bc0ed23d6db9", "Item_Order": 37, "I_description": "IC14", "I_caption": "IC14", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC14]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC14]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC14"}, {"GI_key": "989c8b0a-52d6-4c3b-aa58-e28125c8d817", "Item_Order": 38, "I_description": "IC15", "I_caption": "IC15", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[IC15]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[IC15]!='0'; <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "IC15"}]}]}, {"F_description": "Non inclusion Criteria", "groupes": [{"G_description": "EC", "questions": [{"GI_key": "98d6a618-9207-40c2-8aca-7466bff9242f", "Item_Order": 39, "I_description": "EC01", "I_caption": "EC01", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC01]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC01]!='1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC01"}, {"GI_key": "82a540e7-4720-4c09-b1c9-361b589b9fb1", "Item_Order": 40, "I_description": "EC02", "I_caption": "EC02", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC02]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC02] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC02"}, {"GI_key": "78f037b1-1a2f-447f-9371-7158cc70636a", "Item_Order": 41, "I_description": "EC03", "I_caption": "EC03", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC03]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC03] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC03"}, {"GI_key": "edc7e41c-11d5-4c5b-966a-e9281c339779", "Item_Order": 42, "I_description": "EC04", "I_caption": "EC04", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC04]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC04] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC04"}, {"GI_key": "2917c24e-f564-4b9e-9fc1-05339d94991a", "Item_Order": 43, "I_description": "EC05", "I_caption": "EC05", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC05]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC05] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC05"}, {"GI_key": "4ee3658d-cfde-4eb3-a270-fff915ad8a29", "Item_Order": 44, "I_description": "EC06", "I_caption": "EC06", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC06]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC06] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC06"}, {"GI_key": "6e76e27a-ddd3-428a-b883-b96a149bd0cd", "Item_Order": 45, "I_description": "EC07", "I_caption": "EC07", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC07]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC07] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC07"}, {"GI_key": "adf99e93-d009-4b55-9a6f-0bec9e73c050", "Item_Order": 46, "I_description": "EC08", "I_caption": "EC08", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC08]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC08] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC08"}, {"GI_key": "e1861686-8b43-48d6-93e7-362c3ca8e2d7", "Item_Order": 47, "I_description": "EC09", "I_caption": "EC09", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC09]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC09] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC09"}, {"GI_key": "f8ccdfab-ca04-485b-ae76-dac824d72030", "Item_Order": 48, "I_description": "EC10", "I_caption": "EC10", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC10]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC10] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC10"}, {"GI_key": "2ab0f603-dcd1-4749-8dc1-82f6d4e5fd38", "Item_Order": 49, "I_description": "EC11", "I_caption": "EC11", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC11]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC11] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC11"}, {"GI_key": "e45b5875-950b-4a6b-935b-56b920e22aa9", "Item_Order": 50, "I_description": "EC12", "I_caption": "EC12", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC12]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC12] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC12"}, {"GI_key": "56b90128-859c-43a0-8196-c8e37e120016", "Item_Order": 51, "I_description": "EC13", "I_caption": "EC13", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC13]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC13] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC13"}, {"GI_key": "141849a4-a955-4af5-b861-238e3e6ee909", "Item_Order": 52, "I_description": "EC14", "I_caption": "EC14", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC14]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC14] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC14"}, {"GI_key": "baed243e-6bda-4602-b908-ae6ef2d1f4e3", "Item_Order": 53, "I_description": "EC15", "I_caption": "EC15", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[EC15]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[EC15] != '1' <br>#data Expression <br> <br></code></pre> </td><td> Protocol deviation detected, please verify.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "EC15"}]}]}, {"F_description": "Randomisation request", "groupes": [{"G_description": "CT", "questions": [{"GI_key": "bff64caa-dd12-490b-92c5-c23e4b649c2f", "Item_Order": 54, "I_description": "Center", "I_caption": "CENTER", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][CT.*][CENTER]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>[Trial Template][Site template][SITE][Site Information][Site Name]; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 50", "I_Status": "", "i_SasName": "CENTER"}, {"GI_key": "8ba8f9e3-9dae-46a7-ac2a-94b4b2bf055b", "Item_Order": 55, "I_description": "CRA's name", "I_caption": "CRA", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Valid:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][CT.*][CRA]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>var value=[Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][CT][CRA];<br>NotAnyNumberInString(value); <br>#data Expression <br> <br></code></pre> </td><td> a number is detected, please correct</td> </tr></table></details>", "rep": "Char - 50", "I_Status": "", "i_SasName": "CRA"}, {"GI_key": "501ea1e0-3a98-45c0-8504-35d17737a656", "Item_Order": 56, "I_description": "Investigator's  name", "I_caption": "INV", "Message": "<details> <summary>2 EditCheck </summary><table><tr><td> 22:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][CT.*][INV]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>var incl = [Trial Template][Site template][SITE][LISTINV][INVSYS].ALL;<br><br>var invList = DeleteNullInArray(incl );<br><br>//pour afficher les noms des investigateurs dans l'ordre alphab\u00e9tique :<br>invList.sort();<br>invList; <br></code></pre> </td><td> </td> </tr><tr><td> Valid:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][CT.*][INV]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>var selected=[Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][CT][INV];<br>var madate=TodayDate();<br>var enreg=[Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][ENROLLDT];<br>if (!isEmpty(enreg)) madate=enreg;<br>var AR_listINv=[Trial Template][Site template][SITE][LISTINV][INVSYS].ALL;<br>var AR_desacdate=[Trial Template][Site template][SITE][LISTINV][INVDAT].ALL;<br><br>var lignepat;<br>var desac_dt;<br>var i;<br>var valid=true;<br>for (i = 0; i < AR_listINv.length; i++) {<br>    lignepat=ReturnEntryAtPosition(AR_listINv,i);<br>    desac_dt=ReturnEntryAtPosition(AR_desacdate,i);<br>if (lignepat==selected && !isEmpty(desac_dt) &&  madate>desac_dt )  valid=false;<br>}<br><br>valid; <br>#data Expression <br> <br></code></pre> </td><td> This investigator is not declared for this site anymore. Please choose another investigator.</td> </tr></table></details>", "rep": "Char - 50", "I_Status": "", "i_SasName": "INV"}]}, {"G_description": "STRAT", "questions": [{"GI_key": "f57c78ce-8633-47a6-9935-e896880c9398", "Item_Order": 57, "I_description": "Stratification factor 1", "I_caption": "STRAT1", "Message": null, "rep": "\ud83d\udd18 1 - <b>Response 1</b><br>\ud83d\udd18 2 - <b>Response 2</b>", "I_Status": "", "i_SasName": "STRAT1"}, {"GI_key": "9c87b002-e272-48da-a891-44b711f1b2e9", "Item_Order": 58, "I_description": "Stratification factor 2", "I_caption": "STRAT2", "Message": null, "rep": "\ud83d\udd18 1 - <b>Response 1</b><br>\ud83d\udd18 2 - <b>Response 2</b>", "I_Status": "", "i_SasName": "STRAT2"}]}, {"G_description": "RDConsent", "questions": [{"GI_key": "7cf5bc58-6101-4767-8669-9431627a9d2d", "Item_Order": 59, "I_description": "Informed consent signature date by the patient", "I_caption": "PCONSDT", "Message": null, "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "", "i_SasName": "PCONSDT"}, {"GI_key": "6f233245-6415-4bdb-9945-27a37b9d518f", "Item_Order": 60, "I_description": "Informed consent signature date by the investigator", "I_caption": "ICONSDT", "Message": null, "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "", "i_SasName": "ICONSDT"}, {"GI_key": "80cf3815-dc06-4925-bd84-50bb1e4ac3b0", "Item_Order": 61, "I_description": "Version of informed consent signed", "I_caption": "CONSVERS", "Message": null, "rep": "Char - 50", "I_Status": "", "i_SasName": "CONSVERS"}]}, {"G_description": "OTHERQ", "questions": [{"GI_key": "32b5b221-1927-497e-a55d-50ca8bca11fc", "Item_Order": 62, "I_description": "Additional question 1", "I_caption": "OPTN1", "Message": null, "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "OPTN1"}, {"GI_key": "3885a4e4-b008-468d-a58d-ee406b1ea4d5", "Item_Order": 63, "I_description": "Additional question 2", "I_caption": "OPTN2", "Message": null, "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "OPTN11"}]}, {"G_description": "TAS", "questions": [{"GI_key": "500e05b6-441d-4033-8512-a96080102c1c", "Item_Order": 64, "I_description": "Planned start date of treatment", "I_caption": "PLSDT", "Message": null, "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "", "i_SasName": "PLSDT"}]}, {"G_description": "REQCC", "questions": [{"GI_key": "90124072-710d-46d1-9483-a453f1d6729f", "Item_Order": 65, "I_description": "<i><font color=\"#808080\">Checks are ok for the form 1: inclusion criteria</font></i>", "I_caption": "CHECKIC", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][REQCC.*][CHECKIC]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>if (<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC01]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC02]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC03]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC04]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC05]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC06]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC07]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC08]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC09]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC10]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC11]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC12]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC13]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC14]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][1-Inclusion Criteria][IC][IC15]=='1') '1';<br>else '0'; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "\ud83d\udd12", "i_SasName": "CHECKIC"}, {"GI_key": "a1191ffc-0610-481d-b753-2177b34c598d", "Item_Order": 66, "I_description": "<i><font color=\"#808080\">Checks are ok for the form 2: non inclusion criteria</font></i>", "I_caption": "CHECKEC", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][REQCC.*][CHECKEC]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>if (<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC01] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC02] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC03] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC04] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC05] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC06] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC07] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC08] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC10] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC11] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC12] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC13] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC14] == '0' &&<br>[Trial Template][Site template][Patient Template][Randomisation][2-Non inclusion Criteria][EC][EC15] == '0' ) '1';<br>else '0'; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "\ud83d\udd12", "i_SasName": "CHECKEC"}, {"GI_key": "0292e4f9-0896-4779-b852-f1b44b1f9c9b", "Item_Order": 67, "I_description": "<i><font color=\"#808080\">Checks are ok for the form 3: inclusion request</font></i>", "I_caption": "CHECKREQ", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][REQCC.*][CHECKREQ]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>if (<br>!isEmpty([Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][CT][CRA]) &&<br>!isEmpty([Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][CT][INV]) &&<br>!isEmpty([Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][OTHERQ][OPTN1]) &&<br>!isEmpty([Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][OTHERQ][OPTN2]) &&<br>!isEmpty([Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][TAS][PLSDT]) ) '1';<br>else '0' <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "\ud83d\udd12", "i_SasName": "CHECKREQ"}, {"GI_key": "ff5c619d-f3ae-47a1-b3e3-7afcb2e0d110", "Item_Order": 68, "I_description": "<i><font color=\"#808080\">Final check: authorisation to include the patient (without procotol deviation)</font></i><font color=\"#808080\">", "I_caption": "FCHECK", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVA:[Trial Template][Site template][Patient Template][Randomisation.*][3-Randomisation request.*][REQCC.*][FCHECK]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>if(<br>(<br>[Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][REQCC][CHECKIC]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][REQCC][CHECKEC]=='1' &&<br>[Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][REQCC][CHECKREQ]=='1' ) ||<br>[Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][REQCC][DMOVER]=='1'<br><br>) '1';<br>else '0'; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "\ud83d\udd12", "i_SasName": "FCHECK"}, {"GI_key": "cfcf01c9-361a-4f62-9376-9d18f9760ba8", "Item_Order": 69, "I_description": "<font color=\"#808080\">Overrule all checks (only for Data Manager)</font>", "I_caption": "DMOVER", "Message": "Cat\u00e9rogie:DM<br>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "DMOVER"}]}, {"G_description": "CRACONF", "questions": [{"GI_key": "39c30a9d-a199-4dac-806e-196bbf1dc2ba", "Item_Order": 70, "I_description": "Status of the request", "I_caption": "REQSTATUS", "Message": "<details> <summary>2 EditCheck </summary><table><tr><td> Valid:[Randomisation.*][3-Randomisation request.*][CRACONF.*][REQSTATUS]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[Randomisation][3-Randomisation request][REQCC][FCHECK] == '1'<br>||<br>(<br>[Randomisation][3-Randomisation request][REQCC][FCHECK] == '0'<br>&&<br>([Randomisation][3-Randomisation request][CRACONF][REQSTATUS] == '2' || [Randomisation][3-Randomisation request][CRACONF][REQSTATUS] == '0')<br>)<br>; <br>#data Expression <br> <br></code></pre> </td><td> Protocol(s) deviation(s) detected for the form.</td> </tr><tr><td> Valid:[Randomisation.*][3-Randomisation request.*][CRACONF.*][REQSTATUS]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[Randomisation][3-Randomisation request][REQCC][FCHECK] == '0'<br>||<br>(<br>[Randomisation][3-Randomisation request][REQCC][FCHECK] == '1'<br>&&<br>([Randomisation][3-Randomisation request][CRACONF][REQSTATUS] == '1' || [Randomisation][3-Randomisation request][CRACONF][REQSTATUS] == '0')<br>)<br>; <br>#data Expression <br> <br></code></pre> </td><td> No Protocol(s) deviation(s) detected.</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Proceed with the inclusion (no protocol deviation)</b><br>\ud83d\udd18 2 - <b>Proceed with the inclusion in spite of protocol deviation(s)</b><br>\ud83d\udd18 0 - <b>Do not proceed with the inclusion (screen failure)</b>", "I_Status": "", "i_SasName": "REQSTATU"}, {"GI_key": "5d64a8ad-4a6c-47d3-ad26-cf309c5604ac", "Item_Order": 71, "I_description": "Please verify:", "I_caption": "DISCONF", "Message": "<details> <summary>2 EditCheck </summary><table><tr><td> DVA:[Randomisation.*][3-Randomisation request.*][CRACONF.*][DISCONF]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>var com='';<br>if ([Randomisation][3-Randomisation request][CRACONF][REQSTATUS]==1 && [Randomisation][3-Randomisation request][REQCC][FCHECK] ==0)com+='Protocol(s) deviation(s) detected for the form :';<br>if ([Randomisation][3-Randomisation request][REQCC][CHECKIC]=='0') com += \"-Inclusion criteria;\";<br>if ([Randomisation][3-Randomisation request][REQCC][CHECKEC]=='0') com += \"-Exclusion criteria;\";<br>if ([Randomisation][3-Randomisation request][REQCC][CHECKREQ]=='0') com += \"-on this form (Inclusion request);\";<br>if ([Randomisation][3-Randomisation request][CRACONF][REQSTATUS]==2 && [Randomisation][3-Randomisation request][REQCC][FCHECK] ==1) com+=' No Protocol(s) deviation(s) detected';<br><br><br>com; <br></code></pre> </td><td> </td> </tr><tr><td> Hidden:[Randomisation.*][3-Randomisation request.*][CRACONF.*][DISCONF]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>isEmpty([Randomisation][3-Randomisation request][CRACONF][DISCONF]) <br>#data Expression <br> <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 1", "I_Status": "", "i_SasName": "DISCONF"}, {"GI_key": "119709fc-c2b4-47be-a48b-02d8d22be122", "Item_Order": 72, "I_description": "I confirm that all information are exact", "I_caption": "REQCONF", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> 21:[Randomisation.*][3-Randomisation request.*][CRACONF.*][REQCONF]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[Randomisation][3-Randomisation request][REQCC][FCHECK]!='1'<br>||<br>(<br>[Randomisation][3-Randomisation request][CRACONF][REQSTATUS] == '0'<br>||<br>isEmpty([Randomisation][3-Randomisation request][CRACONF][REQSTATUS])<br>);<br> <br>#data Expression <br> <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Num - 50", "I_Status": "", "i_SasName": "REQCONF"}]}, {"G_description": "WAIV", "questions": [{"GI_key": "8b6f9351-d433-4893-9c22-6c8499711b87", "Item_Order": 73, "I_description": "<i>The criteria entered are not consistent with the criteria required.</i>", "I_caption": "WAIVCOM", "Message": null, "rep": "Char - 1", "I_Status": "", "i_SasName": "WAIVCOM"}, {"GI_key": "27bc0f9a-b333-4db5-9292-1fb2e63ddbb1", "Item_Order": 74, "I_description": "The investigator confirms the registration/randomisation of this patient in spite of the non-respect of an eligibility criteria", "I_caption": "WAIVYN", "Message": "Cat\u00e9rogie:Investigator<br>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "WAIVYN"}, {"GI_key": "5695d7d8-c68b-4a3f-ad38-0e2a35b65663", "Item_Order": 75, "I_description": "Description of the deviation", "I_caption": "WAIV_R", "Message": null, "rep": "Char - 50", "I_Status": "", "i_SasName": "WAIV_R"}]}, {"G_description": "SF", "questions": [{"GI_key": "fad2d4ff-2ced-4bfb-8170-98348fe59e47", "Item_Order": 76, "I_description": "Reason for screen failure", "I_caption": "SF_R", "Message": null, "rep": "\ud83d\udd18 1 - <b>Reason 1</b><br>\ud83d\udd18 2 - <b>Reason 2</b><br>\ud83d\udd18 99 - <b>Other</b>", "I_Status": "", "i_SasName": "SF_R"}, {"GI_key": "690753aa-4310-4cf1-9538-65235e3a5dfd", "Item_Order": 77, "I_description": "If other, specify", "I_caption": "SF_S", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Enabled:[3-Randomisation request.*][SF.*][SF_S]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[3-Randomisation request][SF][SF_R]=='99'; <br>#data Expression <br> <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 50", "I_Status": "", "i_SasName": "SF_S"}]}]}, {"F_description": "Randomisation result", "groupes": [{"G_description": "RRESG", "questions": [{"GI_key": "c4c01a29-3b3a-44f9-b7d0-0c2966311694", "Item_Order": 78, "I_description": "Manual randomisation in case of absence of eCRF (DM only)", "I_caption": "Mrand", "Message": "Cat\u00e9rogie:DM<br>", "rep": "Char - 50", "I_Status": "", "i_SasName": "Mrand"}, {"GI_key": "625388ce-6ff4-45ba-a1eb-82ec843cda2c", "Item_Order": 79, "I_description": "Date of inclusion", "I_caption": "ENROLLDT", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVC:[Trial Template][Site template][Patient Template][Randomisation.*][4-Randomisation result.*][RRESG.*][ENROLLDT]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>isEmpty([Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][ENROLLDT]);<br> <br>#data Expression <br>TodayDate(); <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "\ud83d\udcc5 DD/MM/YYYY", "I_Status": "\ud83d\udd12", "i_SasName": "ENROLLDT"}, {"GI_key": "e566af95-73f8-4c05-be09-073838fa5c38", "Item_Order": 80, "I_description": "Number", "I_caption": "ENROLLID", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVC:[Trial Template][Site template][Patient Template][Randomisation.*][4-Randomisation result.*][RRESG.*][ENROLLID]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>[Trial Template][Site template][Patient Template][PAT][Patient Information][Patient Number]; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 3", "I_Status": "\ud83d\udd12", "i_SasName": "ENROLLID"}, {"GI_key": "7e899359-305a-436b-aeb3-30decb581de1", "Item_Order": 81, "I_description": "FLAGNOTIF", "I_caption": "FLAGNOTIF", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> DVC:[Randomisation.*][4-Randomisation result.*][RRESG.*][FLAGNOTIF]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>true; <br>#data Expression <br>\"1\"; <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 50", "I_Status": "\ud83d\udc7b\ud83d\udd12", "i_SasName": "FLAGNOTI"}, {"GI_key": "44d2a067-762a-4f3f-a38e-ae82d7f4ac37", "Item_Order": 82, "I_description": "Arm", "I_caption": "ARM", "Message": "<details> <summary>2 EditCheck </summary><table><tr><td> DVC:[Trial Template][Site template][Patient Template][Randomisation.*][4-Randomisation result.*][RRESG.*][ARM]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>var arm =[Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][ARM];<br>var strat1= [Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][STRAT][STRAT1];<br>var strat2 = [Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][STRAT][STRAT2];<br>var mrand=[Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][Mrand];<br>!isEmpty(arm) && isEmpty(strat1) && isEmpty(strat2) && mrand != \"1\"; <br>#data Expression <br>var strat1= [Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][STRAT][STRAT1];<br>var strat2 = [Trial Template][Site template][Patient Template][Randomisation][3-Randomisation request][STRAT][STRAT2];<br>GetNextNumberFromTable('ARM',strat1,strat2); <br></code></pre> </td><td> </td> </tr><tr><td> 7:[Trial Template][Site template][Patient Template][Randomisation.*][4-Randomisation result.*][RRESG.*][ARM]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][Mrand] == '1'; <br>#data Expression <br> <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>TRT 1</b><br>\ud83d\udd18 2 - <b>TRT2</b>", "I_Status": "\ud83d\udd12", "i_SasName": "ARM"}, {"GI_key": "593642e8-11e1-4b7e-a39a-c1bb68c61f8c", "Item_Order": 83, "I_description": "Remove read only", "I_caption": "RREAD", "Message": null, "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "RREAD"}, {"GI_key": "9f028646-8502-4fa1-aa63-ebce2d0b972a", "Item_Order": 84, "I_description": "Correction of inclusion data", "I_caption": "COR_YN", "Message": null, "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "COR_YN"}, {"GI_key": "7d6ab2cd-b3c7-4ce0-9bd7-c1b5e090223b", "Item_Order": 85, "I_description": "Resend notification", "I_caption": "RESENDNOT", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Email:[Trial Template][Site template][Patient Template][Randomisation.*][4-Randomisation result.*][RRESG.*][RESENDNOT]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][RESENDNOT] == '1' || isEmpty([Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][FLAGNOTIF]) <br>#data Expression <br><m><s>[Trial Template][TRIAL][Trial][Trial Name] +  ' : New patient '  + [Trial Template][Site template][Patient Template][PAT][Patient Information][Patient Number] + ' has been randomised'</s><b>'<h1>Patient randomisation Notification</h1><p>Dear Team,</p><p>We are pleased to inform you that a new patient has been successfully randomised in the clinical trial <strong>' + [Trial Template][TRIAL][Trial][Trial Name] + '</strong>.</p><p><strong>Patient Details:</strong></p><ul><li><strong>Patient ID:</strong> ' + [Trial Template][Site template][Patient Template][PAT][Patient Information][Patient Number] + '</li><li><strong>Registration Date:</strong> ' + [Trial Template][Site template][Patient Template][Randomisation][4-Randomisation result][RRESG][ENROLLDT] + '</li><li><strong>Site:</strong> ' + [Trial Template][Site template][SITE][Site Information][Site Caption] + '</li></ul><p>Please ensure that all subsequent procedures are performed in accordance with the trial protocol.</p><p>If you have any questions, feel free to contact the study coordinator.</p><p>Best regards,</p><p>the ' + [Trial Template][TRIAL][Trial][Trial Name] + ' team</p><p>This is an automated message. Please do not reply directly to this email.</p><p>For assistance, contact us the study data manager.</p>'<br></b><pt>13b00db2-be45-4611-a60a-ece9de6dac57</pt><pl>2</pl></m> <br></code></pre> </td><td> Randomisation notification</td> </tr></table></details>", "rep": "\ud83d\udd18 1 - <b>Yes</b><br>\ud83d\udd18 0 - <b>No</b>", "I_Status": "", "i_SasName": "RESENDNO"}]}]}, {"F_description": "Correction of randomisation criteria", "groupes": [{"G_description": "COR_G", "questions": [{"GI_key": "ec1d34bd-ec1f-4a88-bd1c-6c2a76408e15", "Item_Order": 86, "I_description": "What is the correction related to?", "I_caption": "COR_R", "Message": null, "rep": "\ud83d\udd18 1 - <b>Reason N\u00b01</b><br>\ud83d\udd18 98 - <b>Stratification criteria AND Other</b><br>\ud83d\udd18 99 - <b>Other</b>", "I_Status": "", "i_SasName": "COR_R"}, {"GI_key": "d707a13b-a791-4ace-9306-1d8c172f2615", "Item_Order": 87, "I_description": "If other, specify", "I_caption": "COR_S", "Message": "<details> <summary>1 EditCheck </summary><table><tr><td> Enabled:[5-Correction of randomisation criteria.*][COR_G.*][COR_S]</td> </tr><tr> <td> <pre><code class='javascript'>#Action Expression <br>[5-Correction of randomisation criteria][COR_G][COR_R] == '98' ||[5-Correction of randomisation criteria][COR_G][COR_R] == '99'; <br>#data Expression <br> <br></code></pre> </td><td> </td> </tr></table></details>", "rep": "Char - 200", "I_Status": "", "i_SasName": "COR_S"}]}]}]}]};


const exportData  = {};
const sidebarLinks = document.getElementById('sidebar-links');
const mainContent = document.getElementById('main-content');

// Générer les liens dynamiquement à partir des visites et fiches
jsonData.visites.forEach((visite, visitIndex) => {
    const vindex= `v${visitIndex}`
    visite.visitIndex = visitIndex;

    // Créer un lien pour la visite
    const visitLink = document.createElement('a');
    visitLink.href =`#${vindex}`;
    visitLink.style = "background-color: #ADD8E6; color: black; padding: 5px; border-radius: 5px; text-decoration: none;";
    visitLink.className = `visit`;
    visitLink.innerText = `${visitIndex + 1}: ${visite.V_description}`;
	generateFiches(visite,vindex);  
    visitLink.addEventListener('click', () => {

        visibleonly(jsonData, 'visite', vindex);
    });
    sidebarLinks.appendChild(visitLink);

    // Parcourir les fiches de la visite
    visite.fiches.forEach((fiche, ficheIndex) => {
        const findex=`v${visitIndex}f${ficheIndex}`;
        fiche.ficheIndex = findex;

        // Créer un lien pour la fiche
        const ficheLink = document.createElement('a');
        ficheLink.href = `#${findex}`;
        ficheLink.className = `form`; // Utilisez `className` ici
        ficheLink.style="margin-left: 20px;"
        ficheLink.innerText = `${ficheIndex + 1}: ${fiche.F_description}`;
        ficheLink.addEventListener('click', () => {
            visibleonly(visite, 'fiche', findex);
        });
        sidebarLinks.appendChild(ficheLink);
    });
});

// Fonction visibleonly
function visibleonly(data, type, index) {

    if (type === 'visite') {

        let h1list = document.getElementsByTagName('h1');

        for (let visit of h1list) {
        // Gérer la visibilité des visites
       
       if (visit.id==index){

        visit.classList.remove('hidden');
        visit.classList.add('show');
        } else {

            visit.classList.remove('show');
            visit.classList.add('hidden');
        }



        };
        

        let sectionlist = document.getElementsByTagName('section');

        for (let section of sectionlist) {
            sectionid=section.id.split('f')[0];;
            if (sectionid==index) {
                section.classList.remove('hidden');
                section.classList.add('show');
            }
        else {
                section.classList.remove('show');
                section.classList.add('hidden');
            }
        }



    } else if (type === 'fiche') {
        let h1list = document.getElementsByTagName('h1');
        for (let visit of h1list) {
            VIsitindex=index.split('f')[0];;
            if (visit.id==VIsitindex) {
                visit.classList.remove('hidden');
                visit.classList.add('show');
            }
        else {
            visit.classList.remove('show');
            visit.classList.add('hidden');
            }

        }


        let sectionlist = document.getElementsByTagName('section');

        for (let section of sectionlist) {
            sectionid=section.id;
            if (sectionid==index) {
                section.classList.remove('hidden');
                section.classList.add('show');
            }
        else {
                section.classList.remove('show');
                section.classList.add('hidden');
            }
        }

    }
}

// Fonction pour ajouter l'écouteur d'événements de manière globale
function updateExportData(td1, td2, td3) {
    const formKey = td1.getAttribute("data-form");
    const sourceKey = td1.getAttribute("data-source");
    const datacaption = td1.getAttribute("data-caption");
    const dataorder = td1.getAttribute("data-order");

    const sourceresp = td2.getAttribute("data-source");
    const sourceSAS = td3.getAttribute("data-source");


    // Récupérer les valeurs actuelles des cellules
    const currentDescription = td1.innerText;
    const currentResponseType = td2.innerText;
    const currentSasName = td3.innerText;

    // Récupérer les valeurs modifiées des champs de saisie
    const modifyTXT1 = document.getElementById(aeraID + '1').value;
    const modifyHTML2 = document.getElementById(aeraID + '2').value;
    const modifyTXT3 = document.getElementById(aeraID + '3').value;
    const displayTxT1 = (modifyTXT1 === sourceKey) ? "N/A" : modifyTXT1;
    const displayTxT2 = (modifyHTML2 === sourceresp) ? "N/A" : modifyHTML2;
    const displayTxT3 = (modifyTXT3 === sourceSAS) ? "N/A" : modifyTXT3;

    // Vérifier s'il y a un changement
    if (modifyTXT1 !== currentDescription || modifyHTML2 !== currentResponseType || modifyTXT3 !== currentSasName) {
        // Si des changements sont détectés, mettre à jour l'objet exportData
        if (!exportData[formKey]) {
            exportData[formKey] = {}; // Initialiser l'objet pour le formulaire s'il n'existe pas
        }
        exportData[formKey][datacaption] = {
            dataorder:dataorder,
            description: displayTxT1,
            responseType: displayTxT2,
            sasName: displayTxT3
        };

        // Appeler la fonction de mise à jour de la liste des changements
        updateChangeLog();
    }
}

function addGlobalClickListener() {
    document.addEventListener('click', (event) => {
        if (event.target && (event.target.innerHTML === '✏️' || event.target.innerHTML === '💾')) {
            originID = event.target.getAttribute("id").substr(3);

            td0 = document.getElementById('td0' + originID);
            td1 = document.getElementById('td1' + originID);
            td2 = document.getElementById('td2' + originID);
            td3 = document.getElementById('td3' + originID);
            But = document.getElementById("But" + originID);

            aeraID = 'ARE' + originID;

            if (event.target && event.target.innerHTML === '✏️') {
                // Récupérer les valeurs existantes
                previousTXT = td1.innerHTML;
                previousHTML2 = td2.innerHTML; // Contenu de td2
                previousTXT3 = td3.innerText;

                // Remplacer le texte statique par des champs texte (textarea)
                td1.innerHTML = '';
                td2.innerHTML = '';
                td3.innerHTML = '';

                const inputField1 = document.createElement('textarea');
                inputField1.id = aeraID + '1';
                inputField1.innerText = previousTXT || ''; // Valeur actuelle de td1
                td1.appendChild(inputField1);

                const inputField2 = document.createElement('textarea');
                inputField2.id = aeraID + '2';
                inputField2.innerText = previousHTML2; // Valeur actuelle de td2
                td2.appendChild(inputField2);

                const inputField3 = document.createElement('textarea');
                inputField3.id = aeraID + '3';
                inputField3.innerText = previousTXT3 || ''; // Valeur actuelle de td3
                td3.appendChild(inputField3);

                // Créer un bouton "Save"
                td0.innerHTML = '';
                const saveButton = document.createElement('button');
                saveButton.id = "But" + originID;
                saveButton.innerHTML = '💾';
                td0.appendChild(saveButton);
            }

            // Quand on clique sur "Save", sauvegarder la modification
            if (event.target && event.target.innerHTML === '💾') {
                updateExportData(td1, td2, td3);

                const modifyTXT1 = document.getElementById(aeraID + '1').value;
                const modifyHTML2 = document.getElementById(aeraID + '2').value;
                const modifyTXT3 = document.getElementById(aeraID + '3').value;

              

                // Mise à jour de td1, td2, et td3 avec les nouvelles valeurs
                td1.innerHTML = modifyTXT1;
                td2.innerHTML = modifyHTML2;
                td3.innerHTML = modifyTXT3;

                // Remise à zéro de td0 et ajout du bouton "Modifier"
                td0.innerHTML = '🔴';
                const modButton = document.createElement('button');
                modButton.id = "But" + originID;
                modButton.innerHTML = '✏️';
                td0.appendChild(modButton);
            }
        }
    });
}


         addGlobalClickListener()        
// Fonction pour générer les fiches
function generateFiche(fiche, activate, fid) {
    // Créer la section
    const section = document.createElement('section');
    section.id = `${fid}`;
    section.className="no-break"

    const h2 = document.createElement('h2');
        h2.innerText = fiche.F_description;
        section.appendChild(h2);
    // Parcourir les groupes
    fiche.groupes.forEach(groupe => {
        // Ajouter un titre pour le groupe
        const h3 = document.createElement('h3');
        h3.innerText = groupe.G_description;
        section.appendChild(h3);

        // Créer une table pour les questions
        const table = document.createElement('table');
        table.className="no-break"

        // Ajouter l'en-tête de la table
        const headerRow = document.createElement('tr');
        const th0 = document.createElement('th');
        th0.innerText = '🛠️';
        th0.style.width = '1px';
        th0.style.whiteSpace = 'nowrap';
        th0.setAttribute('data-visual', "DM");
        const th1 = document.createElement('th');
        th1.innerText = 'Question Description';

        const th2 = document.createElement('th');
        th2.innerText = 'Response';
        const th3 = document.createElement('th');
        th3.innerText = 'Sas';
        th3.setAttribute('data-visual', "DM");
        const th4 = document.createElement('th');
        th4.innerText = 'EditCheck';
        th4.setAttribute('data-visual', "DM");
        th4.className="no-print";
        const th5 = document.createElement('th');
        th5.innerText = 'Report';
        th5.setAttribute('data-visual', "DM");
        th5.className="no-print";



        headerRow.appendChild(th0);
        headerRow.appendChild(th1);
        headerRow.appendChild(th2);
        headerRow.appendChild(th3);
        headerRow.appendChild(th4);
        headerRow.appendChild(th5);

        table.appendChild(headerRow);

        // Ajouter les lignes pour chaque question
        index=0
        groupe.questions.forEach(question => {
            index+=1
            const row = document.createElement('tr');

            // Colonne pour l'outil
            const td0 = document.createElement('td');
            td0.setAttribute('data-visual', "DM");
            td0.id = `td0${question.GI_key}`;
            const editButton = document.createElement('button');
            editButton.innerHTML = '✏️';
            editButton.id = `But${question.GI_key}`;
            editButton.className="no-print";
            td0.appendChild(editButton);

            // Colonne pour la description
            const td1 = document.createElement('td');
            td1.innerHTML = question.I_description || 'N/A';
            td1.id = `td1${question.GI_key}`;
            td1.setAttribute('data-source', question.I_description);
            td1.setAttribute('data-form', fiche.F_description);
            td1.setAttribute('data-caption', question.I_caption);
            td1.setAttribute('data-order', question.Item_Order);
            

            // Colonne pour la réponse
            const td2 = document.createElement('td');
            td2.innerHTML = question.rep || 'N/A';
            td2.id = `td2${question.GI_key}`;
            td2.setAttribute('data-source', question.rep);

            const td3 = document.createElement('td');
            td3.innerHTML = question.i_SasName || 'N/A';
            td3.setAttribute('data-visual', "DM");
            td3.id = `td3${question.GI_key}`;
            td3.setAttribute('data-source', question.i_SasName);

            const td4 = document.createElement('td'); // Crée une cellule de tableau
            td4.setAttribute('data-visual', "DM");
            td4.className="no-print";

            
            td4.innerHTML = question.Message; // Ajoute l'emoji au bouton
            
            const td5 = document.createElement('td'); // Crée une cellule de tableau
            td5.classList.add('center-content'); // Ajoute la classe pour le centrage

            td5.setAttribute('data-visual', "DM");
            td5.className="no-print";
            const issue = document.createElement('button'); // Crée un bouton
            issue.innerHTML = "❗"; // Ajoute l'emoji au bouton
            issue.id = "report-issue"; // Donne un ID au bouton
            issue.setAttribute('data-fiche', fiche.F_description);
            issue.setAttribute('data-question', question.I_description);
            issue.setAttribute('data-SasName', question.i_SasName);
            issue.addEventListener('click', () => {
                const ficheDescription = event.target.getAttribute('data-fiche');
                const questionDescription = event.target.getAttribute('data-question');
                const SasName = event.target.getAttribute('data-SasName');

                // Remplacez l'URL avec votre propre logique
                title= ` Problème avec ${ficheDescription} SasName:${SasName}`;
                description = `# Problème identifié sur : <br>## fiche:${ficheDescription} <br>### SasName:${SasName} <br><br> question= ${questionDescription} <br><br> détail :`;

                const url = `https://github.com/Anmangin/XML_TM/issues/new?title=${encodeURIComponent(title)}&body=${encodeURIComponent(description)}&labels=bug`;
                window.open(url, '_blank');
            });

            td5.appendChild(issue); // Ajoute le bouton à la cellule

            
            // Ajouter les colonnes à la ligne
            
            row.appendChild(td0);
            row.appendChild(td1);
            row.appendChild(td2);
            row.appendChild(td3);
            row.appendChild(td4);
            row.appendChild(td5);


            // Ajouter la ligne au tableau
            table.appendChild(row);
            const rowp = document.createElement('tr');
rowp.style.position = "relative"; // Position de la ligne pour utiliser la position absolue de la cellule
rowp.style.height = "0px"; // Hauteur de la ligne
rowp.style.overflow = "hidden"; // Permet au contenu de dépasser la hauteur
rowp.style.visibility = "hidden"; // Masque la ligne, mais pas son contenu

// const tdx = document.createElement('td');
// tdx.colSpan = 6; // Ajustez selon le nombre de colonnes
// tdx.style.position = "absolute"; // Permet de positionner le texte par-dessus le tableau
// tdx.style.top = "0px"; // Positionne le texte à l'endroit souhaité (ajustez si nécessaire)
// tdx.style.left = "0px"; // Positionne le texte à l'endroit souhaité (ajustez si nécessaire)
// tdx.style.textAlign = 'left';
// tdx.style.zIndex = "10"; // Place le texte au-dessus des autres éléments (ajustez si nécessaire)
// tdx.textContent = '+'; // Contenu du texte

// // Ajoutez la cellule au tableau
// rowp.appendChild(tdx);
// table.appendChild(rowp);

          
        });

            // Ajouter une ligne de séparation "+" après chaque ligne sauf la dernière
   

        // Ajouter la table à la section
        section.appendChild(table);
    });

    // Ajouter la section au contenu principal
    mainContent.appendChild(section);
}



window.addEventListener('beforeunload', (event) => {
    // Vous pouvez définir un message personnalisé (en fonction du navigateur, il peut ne pas s'afficher)
    const message = "Êtes-vous sûr de vouloir quitter cette page ? Toutes les modifications non enregistrées seront perdues.";

    // Certains navigateurs ne tiennent pas compte du message personnalisé,
    // mais l'événement doit être annulé pour afficher l'avertissement.
    event.returnValue = message;  // Standard
    return message;  // Pour certains navigateurs (comme Chrome)
});
        // Function to generate all fiches for a visit
        function generateFiches(visite,vid) {

            const h1 = document.createElement('h1');
            h1.innerText = "Visite " + visite.V_description;
            h1.id = `${vid}`
            mainContent.appendChild(h1);
     
            n=0
            activate=true;
            Fidex=0

            visite.fiches.forEach(fiche => {               
                generateFiche(fiche,activate,`${vid}f${Fidex}`); // Use the same function to generate each fiche in the visit
                Fidex += 1;
                activate=false;


                
            });
      
        }

    

    </script>

<script>
   
    // Récupère le bouton et ajoute un événement de clic
    const toggleButton = document.getElementById('toggle-button');

    toggleButton.addEventListener('click', () => {
        const currentState = toggleButton.getAttribute('data-state');
        let newState, buttonText;

        // Basculer entre les deux états
        if (currentState === "DM") {
            newState = "Investigateur";
            buttonText = "Investigateur";
            toggleButton.classList.remove('pressed');
            toggleButton.classList.add('released');
        } else {
            newState = "DM";
            buttonText = "DM";
            toggleButton.classList.remove('released');
            toggleButton.classList.add('pressed');
        }

        // Met à jour l'état du bouton
        toggleButton.setAttribute('data-state', newState);
        toggleButton.innerText = buttonText;

        // Afficher/Masquer les éléments en fonction de l'état
        document.querySelectorAll('[data-visual]').forEach(el => {
            if (el.getAttribute('data-visual') === newState) {
                el.style.display = "table-cell";
            } else {
                el.style.display = "none";
            }
        });
    });

    // Afficher initialement les éléments de l'état par défaut (DM)
    document.querySelectorAll('[data-visual="DM"]').forEach(el => {
        el.style.display = "table-cell";
    });




        let h1list = document.getElementsByTagName('h1');
        let sectionlist = document.getElementsByTagName('section');

        for (let section of sectionlist) {
                section.classList.remove('hidden');
                section.classList.add('show');
        }

        for (let title of h1list) {
            title.classList.remove('hidden');
            title.classList.add('show');
        }

// Fonction pour afficher les changements dans la section du tableau


function updateChangeLog() {
    const changeList = document.getElementById('change-list');
    changeList.innerHTML = ''; // Réinitialiser le corps du tableau avant de le remplir

    // Vérifier s'il y a des modifications enregistrées
    if (Object.keys(exportData).length > 0) {
        // Trier l'objet exportData par la propriété dataorder
        const sortedEntries = Object.entries(exportData).sort(([, a], [, b]) => a.dataorder - b.dataorder);
        
        for (const [formKey, formValue] of sortedEntries) {
            for (const [sourceKey, value] of Object.entries(formValue)) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formKey}</td>
                    <td>${sourceKey}</td>
                    <td>${value.description}</td>
                    <td>${value.responseType}</td>
                    <td>${value.sasName}</td>
                `;
                changeList.appendChild(row);
            }
        }
    } else {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td colspan="5" style="text-align: center;">Aucun changement enregistré.</td>
        `;
        changeList.appendChild(row);
    }
}

</script>


</body>

</html>
